package com.example.nutritionanalysis.ui.totalAnalysisFragment

import android.os.Bundle
import androidx.test.espresso.Espresso.onView
import androidx.test.espresso.assertion.ViewAssertions.matches
import androidx.test.espresso.matcher.ViewMatchers.*
import androidx.test.ext.junit.runners.AndroidJUnit4
import com.example.nutritionanalysis.R
import com.example.nutritionanalysis.data.model.NutritionResponse
import com.example.nutritionanalysis.launchFragmentInHiltContainer
import com.google.gson.Gson
import kotlinx.coroutines.ExperimentalCoroutinesApi
import org.junit.Test
import org.junit.runner.RunWith
import kotlin.math.roundToInt

@ExperimentalCoroutinesApi
@RunWith(AndroidJUnit4::class)
class TotalAnalysisFragmentTest{

    @Test
    fun test_totalAnalysisFragment_inView() {

        val response =
            "{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#recipe_976d90a29edf482d9b3fcedb7670f339\",\"yield\":4.0,\"calories\":1539,\"totalWeight\":1236.8342985282761,\"dietLabels\":[\"LOW_FAT\",\"LOW_SODIUM\"],\"healthLabels\":[\"LOW_FAT_ABS\",\"SUGAR_CONSCIOUS\",\"VEGAN\",\"VEGETARIAN\",\"PESCATARIAN\",\"DAIRY_FREE\",\"GLUTEN_FREE\",\"WHEAT_FREE\",\"EGG_FREE\",\"MILK_FREE\",\"PEANUT_FREE\",\"TREE_NUT_FREE\",\"SOY_FREE\",\"FISH_FREE\",\"SHELLFISH_FREE\",\"PORK_FREE\",\"RED_MEAT_FREE\",\"CRUSTACEAN_FREE\",\"CELERY_FREE\",\"MUSTARD_FREE\",\"SESAME_FREE\",\"LUPINE_FREE\",\"MOLLUSK_FREE\",\"NO_OIL_ADDED\",\"KOSHER\"],\"cautions\":[\"SULFITES\"],\"totalNutrients\":{\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":1539.644654215969,\"unit\":\"kcal\"},\"FAT\":{\"label\":\"Fat\",\"quantity\":4.5556223935,\"unit\":\"g\"},\"FASAT\":{\"label\":\"Saturated\",\"quantity\":0.6547352488875,\"unit\":\"g\"},\"FAMS\":{\"label\":\"Monounsaturated\",\"quantity\":1.1360658668625,\"unit\":\"g\"},\"FAPU\":{\"label\":\"Polyunsaturated\",\"quantity\":1.8601809530875002,\"unit\":\"g\"},\"CHOCDF\":{\"label\":\"Carbs\",\"quantity\":211.46532847634413,\"unit\":\"g\"},\"FIBTG\":{\"label\":\"Fiber\",\"quantity\":6.9172836425,\"unit\":\"g\"},\"SUGAR\":{\"label\":\"Sugars\",\"quantity\":11.97706644174838,\"unit\":\"g\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":25.019489443969796,\"unit\":\"g\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":0.0,\"unit\":\"mg\"},\"NA\":{\"label\":\"Sodium\",\"quantity\":60.074533713913794,\"unit\":\"mg\"},\"CA\":{\"label\":\"Calcium\",\"quantity\":109.71927654476207,\"unit\":\"mg\"},\"MG\":{\"label\":\"Magnesium\",\"quantity\":202.4471242881104,\"unit\":\"mg\"},\"K\":{\"label\":\"Potassium\",\"quantity\":1403.1430518304933,\"unit\":\"mg\"},\"FE\":{\"label\":\"Iron\",\"quantity\":6.819229326804621,\"unit\":\"mg\"},\"ZN\":{\"label\":\"Zinc\",\"quantity\":4.8468695044617585,\"unit\":\"mg\"},\"P\":{\"label\":\"Phosphorus\",\"quantity\":505.4786470056552,\"unit\":\"mg\"},\"VITA_RAE\":{\"label\":\"Vitamin A\",\"quantity\":1.7009713875,\"unit\":\"µg\"},\"VITC\":{\"label\":\"Vitamin C\",\"quantity\":2.2679618500000003,\"unit\":\"mg\"},\"THIA\":{\"label\":\"Thiamin (B1)\",\"quantity\":0.4443612132264138,\"unit\":\"mg\"},\"RIBF\":{\"label\":\"Riboflavin (B2)\",\"quantity\":0.4190530860740035,\"unit\":\"mg\"},\"NIA\":{\"label\":\"Niacin (B3)\",\"quantity\":5.235636821494438,\"unit\":\"mg\"},\"VITB6A\":{\"label\":\"Vitamin B6\",\"quantity\":0.990082933667769,\"unit\":\"mg\"},\"FOLDFE\":{\"label\":\"Folate equivalent (total)\",\"quantity\":352.6950401352828,\"unit\":\"µg\"},\"FOLFD\":{\"label\":\"Folate (food)\",\"quantity\":352.6950401352828,\"unit\":\"µg\"},\"FOLAC\":{\"label\":\"Folic acid\",\"quantity\":0.0,\"unit\":\"µg\"},\"VITB12\":{\"label\":\"Vitamin B12\",\"quantity\":0.0,\"unit\":\"µg\"},\"VITD\":{\"label\":\"Vitamin D\",\"quantity\":0.0,\"unit\":\"µg\"},\"TOCPHA\":{\"label\":\"Vitamin E\",\"quantity\":0.46493217925,\"unit\":\"mg\"},\"VITK1\":{\"label\":\"Vitamin K\",\"quantity\":5.1029141625,\"unit\":\"µg\"},\"WATER\":{\"label\":\"Water\",\"quantity\":913.5144881745314,\"unit\":\"g\"}},\"totalDaily\":{\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":76.98223271079844,\"unit\":\"%\"},\"FAT\":{\"label\":\"Fat\",\"quantity\":7.008649836153847,\"unit\":\"%\"},\"FASAT\":{\"label\":\"Saturated\",\"quantity\":3.2736762444375005,\"unit\":\"%\"},\"CHOCDF\":{\"label\":\"Carbs\",\"quantity\":70.48844282544803,\"unit\":\"%\"},\"FIBTG\":{\"label\":\"Fiber\",\"quantity\":27.66913457,\"unit\":\"%\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":50.03897888793959,\"unit\":\"%\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":0.0,\"unit\":\"%\"},\"NA\":{\"label\":\"Sodium\",\"quantity\":2.5031055714130748,\"unit\":\"%\"},\"CA\":{\"label\":\"Calcium\",\"quantity\":10.971927654476207,\"unit\":\"%\"},\"MG\":{\"label\":\"Magnesium\",\"quantity\":48.201696259073906,\"unit\":\"%\"},\"K\":{\"label\":\"Potassium\",\"quantity\":29.854107485755176,\"unit\":\"%\"},\"FE\":{\"label\":\"Iron\",\"quantity\":37.88460737113678,\"unit\":\"%\"},\"ZN\":{\"label\":\"Zinc\",\"quantity\":44.06245004056144,\"unit\":\"%\"},\"P\":{\"label\":\"Phosphorus\",\"quantity\":72.21123528652217,\"unit\":\"%\"},\"VITA_RAE\":{\"label\":\"Vitamin A\",\"quantity\":0.18899682083333333,\"unit\":\"%\"},\"VITC\":{\"label\":\"Vitamin C\",\"quantity\":2.5199576111111117,\"unit\":\"%\"},\"THIA\":{\"label\":\"Thiamin (B1)\",\"quantity\":37.03010110220116,\"unit\":\"%\"},\"RIBF\":{\"label\":\"Riboflavin (B2)\",\"quantity\":32.23485277492335,\"unit\":\"%\"},\"NIA\":{\"label\":\"Niacin (B3)\",\"quantity\":32.72273013434024,\"unit\":\"%\"},\"VITB6A\":{\"label\":\"Vitamin B6\",\"quantity\":76.16022566675146,\"unit\":\"%\"},\"FOLDFE\":{\"label\":\"Folate equivalent (total)\",\"quantity\":88.17376003382068,\"unit\":\"%\"},\"VITB12\":{\"label\":\"Vitamin B12\",\"quantity\":0.0,\"unit\":\"%\"},\"VITD\":{\"label\":\"Vitamin D\",\"quantity\":0.0,\"unit\":\"%\"},\"TOCPHA\":{\"label\":\"Vitamin E\",\"quantity\":3.0995478616666667,\"unit\":\"%\"},\"VITK1\":{\"label\":\"Vitamin K\",\"quantity\":4.252428468750001,\"unit\":\"%\"}},\"ingredients\":[{\"text\":\"1 cup rice\",\"parsed\":[{\"quantity\":1.0,\"measure\":\"cup\",\"foodMatch\":\"rice\",\"food\":\"rice\",\"foodId\":\"food_bpumdjzb5rtqaeabb0kbgbcgr4t9\",\"weight\":195.0,\"retainedWeight\":195.0,\"nutrients\":{\"RIBF\":{\"label\":\"Riboflavin\",\"quantity\":0.09359999999999999,\"unit\":\"mg\"},\"VITD\":{\"label\":\"Vitamin D\",\"quantity\":0.0,\"unit\":\"IU\"},\"THIA\":{\"label\":\"Thiamin\",\"quantity\":0.1365,\"unit\":\"mg\"},\"FAPU\":{\"label\":\"Fatty acids, total polyunsaturated\",\"quantity\":0.30225,\"unit\":\"g\"},\"NIA\":{\"label\":\"Niacin\",\"quantity\":3.12,\"unit\":\"mg\"},\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":702.0,\"unit\":\"kcal\"},\"FASAT\":{\"label\":\"Fatty acids, total saturated\",\"quantity\":0.3081,\"unit\":\"g\"},\"VITC\":{\"label\":\"Vitamin C, total ascorbic acid\",\"quantity\":0.0,\"unit\":\"mg\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":12.8895,\"unit\":\"g\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":0.0,\"unit\":\"mg\"},\"FAMS\":{\"label\":\"Fatty acids, total monounsaturated\",\"quantity\":0.35295000000000004,\"unit\":\"g\"},\"CHOCDF\":{\"label\":\"Carbohydrate, by difference\",\"quantity\":154.71300000000002,\"unit\":\"g\"},\"FAT\":{\"label\":\"Total lipid (fat)\",\"quantity\":1.131,\"unit\":\"g\"},\"VITB6A\":{\"label\":\"Vitamin B-6\",\"quantity\":0.28275,\"unit\":\"mg\"},\"VITB12\":{\"label\":\"Vitamin B-12\",\"quantity\":0.0,\"unit\":\"µg\"},\"WATER\":{\"label\":\"Water\",\"quantity\":25.1355,\"unit\":\"g\"},\"K\":{\"label\":\"Potassium, K\",\"quantity\":167.7,\"unit\":\"mg\"},\"P\":{\"label\":\"Phosphorus, P\",\"quantity\":210.6,\"unit\":\"mg\"},\"NA\":{\"label\":\"Sodium, Na\",\"quantity\":1.95,\"unit\":\"mg\"},\"ZN\":{\"label\":\"Zinc, Zn\",\"quantity\":2.262,\"unit\":\"mg\"},\"CA\":{\"label\":\"Calcium, Ca\",\"quantity\":17.55,\"unit\":\"mg\"},\"MG\":{\"label\":\"Magnesium, Mg\",\"quantity\":68.25,\"unit\":\"mg\"},\"FE\":{\"label\":\"Iron, Fe\",\"quantity\":1.56,\"unit\":\"mg\"},\"FOLFD\":{\"label\":\"Folate, food\",\"quantity\":17.55,\"unit\":\"µg\"},\"FOLAC\":{\"label\":\"Folic acid\",\"quantity\":0.0,\"unit\":\"µg\"},\"FOLDFE\":{\"label\":\"Folate, DFE\",\"quantity\":17.55,\"unit\":\"µg\"}},\"measureURI\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_cup\",\"status\":\"OK\"}]},{\"text\":\"2 oz chickpeas\",\"parsed\":[{\"quantity\":2.0,\"measure\":\"ounce\",\"foodMatch\":\"chickpeas\",\"food\":\"bengal gram\",\"foodId\":\"food_baux5rqbkto336asd7w3lbbi1koo\",\"weight\":56.69904625,\"retainedWeight\":56.69904625,\"nutrients\":{\"RIBF\":{\"label\":\"Riboflavin\",\"quantity\":0.12020197805,\"unit\":\"mg\"},\"VITD\":{\"label\":\"Vitamin D\",\"quantity\":0.0,\"unit\":\"IU\"},\"THIA\":{\"label\":\"Thiamin\",\"quantity\":0.2704544506125,\"unit\":\"mg\"},\"FAPU\":{\"label\":\"Fatty acids, total polyunsaturated\",\"quantity\":1.5484509530875,\"unit\":\"g\"},\"NIA\":{\"label\":\"Niacin\",\"quantity\":0.8737323027124999,\"unit\":\"mg\"},\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":214.322394825,\"unit\":\"kcal\"},\"FASAT\":{\"label\":\"Fatty acids, total saturated\",\"quantity\":0.3418952488875,\"unit\":\"g\"},\"VITA_RAE\":{\"label\":\"Vitamin A, RAE\",\"quantity\":1.7009713875,\"unit\":\"µg\"},\"VITC\":{\"label\":\"Vitamin C, total ascorbic acid\",\"quantity\":2.2679618500000003,\"unit\":\"mg\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":11.606294767375,\"unit\":\"g\"},\"TOCPHA\":{\"label\":\"Vitamin E (alpha-tocopherol)\",\"quantity\":0.46493217924999997,\"unit\":\"mg\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":0.0,\"unit\":\"mg\"},\"FAMS\":{\"label\":\"Fatty acids, total monounsaturated\",\"quantity\":0.7807458668625,\"unit\":\"g\"},\"CHOCDF\":{\"label\":\"Carbohydrate, by difference\",\"quantity\":35.69204961437501,\"unit\":\"g\"},\"FAT\":{\"label\":\"Total lipid (fat)\",\"quantity\":3.4246223935,\"unit\":\"g\"},\"VITB6A\":{\"label\":\"Vitamin B-6\",\"quantity\":0.3033398974375,\"unit\":\"mg\"},\"VITB12\":{\"label\":\"Vitamin B-12\",\"quantity\":0.0,\"unit\":\"µg\"},\"FIBTG\":{\"label\":\"Fiber, total dietary\",\"quantity\":6.9172836425,\"unit\":\"g\"},\"WATER\":{\"label\":\"Water\",\"quantity\":4.354486752000001,\"unit\":\"g\"},\"K\":{\"label\":\"Potassium, K\",\"quantity\":407.099152075,\"unit\":\"mg\"},\"P\":{\"label\":\"Phosphorus, P\",\"quantity\":142.88159655,\"unit\":\"mg\"},\"NA\":{\"label\":\"Sodium, Na\",\"quantity\":13.6077711,\"unit\":\"mg\"},\"ZN\":{\"label\":\"Zinc, Zn\",\"quantity\":1.5648936764999999,\"unit\":\"mg\"},\"SUGAR\":{\"label\":\"Sugars, total\",\"quantity\":6.06679794875,\"unit\":\"g\"},\"CA\":{\"label\":\"Calcium, Ca\",\"quantity\":32.3184563625,\"unit\":\"mg\"},\"MG\":{\"label\":\"Magnesium, Mg\",\"quantity\":44.792246537500006,\"unit\":\"mg\"},\"FE\":{\"label\":\"Iron, Fe\",\"quantity\":2.443728893375,\"unit\":\"mg\"},\"VITK1\":{\"label\":\"Vitamin K (phylloquinone)\",\"quantity\":5.1029141625,\"unit\":\"µg\"},\"FOLFD\":{\"label\":\"Folate, food\",\"quantity\":315.8136876125,\"unit\":\"µg\"},\"FOLAC\":{\"label\":\"Folic acid\",\"quantity\":0.0,\"unit\":\"µg\"},\"FOLDFE\":{\"label\":\"Folate, DFE\",\"quantity\":315.8136876125,\"unit\":\"µg\"}},\"measureURI\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"status\":\"OK\"}]},{\"text\":\"1 bottle wine\",\"parsed\":[{\"quantity\":1.0,\"measure\":\"bottle\",\"foodMatch\":\"wine\",\"food\":\"wine\",\"foodId\":\"food_bw5p1agbubb4dubpm8r0yax8fjco\",\"weight\":748.135252278276,\"retainedWeight\":748.135252278276,\"nutrients\":{\"RIBF\":{\"label\":\"Riboflavin\",\"quantity\":0.17207110802400347,\"unit\":\"mg\"},\"VITD\":{\"label\":\"Vitamin D\",\"quantity\":0.0,\"unit\":\"IU\"},\"THIA\":{\"label\":\"Thiamin\",\"quantity\":0.0374067626139138,\"unit\":\"mg\"},\"FAPU\":{\"label\":\"Fatty acids, total polyunsaturated\",\"quantity\":0.0,\"unit\":\"g\"},\"NIA\":{\"label\":\"Niacin\",\"quantity\":1.2419045187819382,\"unit\":\"mg\"},\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":620.9522593909691,\"unit\":\"kcal\"},\"FASAT\":{\"label\":\"Fatty acids, total saturated\",\"quantity\":0.0,\"unit\":\"g\"},\"VITA_RAE\":{\"label\":\"Vitamin A, RAE\",\"quantity\":0.0,\"unit\":\"µg\"},\"VITC\":{\"label\":\"Vitamin C, total ascorbic acid\",\"quantity\":0.0,\"unit\":\"mg\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":0.5236946765947933,\"unit\":\"g\"},\"TOCPHA\":{\"label\":\"Vitamin E (alpha-tocopherol)\",\"quantity\":0.0,\"unit\":\"mg\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":0.0,\"unit\":\"mg\"},\"FAMS\":{\"label\":\"Fatty acids, total monounsaturated\",\"quantity\":0.0,\"unit\":\"g\"},\"CHOCDF\":{\"label\":\"Carbohydrate, by difference\",\"quantity\":20.349278861969108,\"unit\":\"g\"},\"FAT\":{\"label\":\"Total lipid (fat)\",\"quantity\":0.0,\"unit\":\"g\"},\"VITB6A\":{\"label\":\"Vitamin B-6\",\"quantity\":0.40399303623026905,\"unit\":\"mg\"},\"VITB12\":{\"label\":\"Vitamin B-12\",\"quantity\":0.0,\"unit\":\"µg\"},\"FIBTG\":{\"label\":\"Fiber, total dietary\",\"quantity\":0.0,\"unit\":\"g\"},\"WATER\":{\"label\":\"Water\",\"quantity\":647.7355014225313,\"unit\":\"g\"},\"K\":{\"label\":\"Potassium, K\",\"quantity\":740.6538997554932,\"unit\":\"mg\"},\"P\":{\"label\":\"Phosphorus, P\",\"quantity\":149.6270504556552,\"unit\":\"mg\"},\"NA\":{\"label\":\"Sodium, Na\",\"quantity\":37.4067626139138,\"unit\":\"mg\"},\"ZN\":{\"label\":\"Zinc, Zn\",\"quantity\":0.9725758279617588,\"unit\":\"mg\"},\"SUGAR\":{\"label\":\"Sugars, total\",\"quantity\":5.910268492998381,\"unit\":\"g\"},\"CA\":{\"label\":\"Calcium, Ca\",\"quantity\":59.850820182262076,\"unit\":\"mg\"},\"MG\":{\"label\":\"Magnesium, Mg\",\"quantity\":82.29487775061035,\"unit\":\"mg\"},\"FE\":{\"label\":\"Iron, Fe\",\"quantity\":2.768100433429621,\"unit\":\"mg\"},\"VITK1\":{\"label\":\"Vitamin K (phylloquinone)\",\"quantity\":0.0,\"unit\":\"µg\"},\"FOLFD\":{\"label\":\"Folate, food\",\"quantity\":7.4813525227827595,\"unit\":\"µg\"},\"FOLAC\":{\"label\":\"Folic acid\",\"quantity\":0.0,\"unit\":\"µg\"},\"FOLDFE\":{\"label\":\"Folate, DFE\",\"quantity\":7.4813525227827595,\"unit\":\"µg\"}},\"measureURI\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_bottle\",\"status\":\"OK\"}]},{\"text\":\"1 cup tea\",\"parsed\":[{\"quantity\":1.0,\"measure\":\"cup\",\"foodMatch\":\"tea\",\"food\":\"black tea\",\"foodId\":\"food_b8aoe5qbgar9fbbcvdj8ea7ekske\",\"weight\":237.0,\"retainedWeight\":237.0,\"nutrients\":{\"RIBF\":{\"label\":\"Riboflavin\",\"quantity\":0.03318,\"unit\":\"mg\"},\"VITD\":{\"label\":\"Vitamin D\",\"quantity\":0.0,\"unit\":\"IU\"},\"THIA\":{\"label\":\"Thiamin\",\"quantity\":0.0,\"unit\":\"mg\"},\"FAPU\":{\"label\":\"Fatty acids, total polyunsaturated\",\"quantity\":0.00948,\"unit\":\"g\"},\"NIA\":{\"label\":\"Niacin\",\"quantity\":0.0,\"unit\":\"mg\"},\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":2.37,\"unit\":\"kcal\"},\"FASAT\":{\"label\":\"Fatty acids, total saturated\",\"quantity\":0.00474,\"unit\":\"g\"},\"VITA_RAE\":{\"label\":\"Vitamin A, RAE\",\"quantity\":0.0,\"unit\":\"µg\"},\"VITC\":{\"label\":\"Vitamin C, total ascorbic acid\",\"quantity\":0.0,\"unit\":\"mg\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":0.0,\"unit\":\"g\"},\"TOCPHA\":{\"label\":\"Vitamin E (alpha-tocopherol)\",\"quantity\":0.0,\"unit\":\"mg\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":0.0,\"unit\":\"mg\"},\"FAMS\":{\"label\":\"Fatty acids, total monounsaturated\",\"quantity\":0.00237,\"unit\":\"g\"},\"CHOCDF\":{\"label\":\"Carbohydrate, by difference\",\"quantity\":0.711,\"unit\":\"g\"},\"FAT\":{\"label\":\"Total lipid (fat)\",\"quantity\":0.0,\"unit\":\"g\"},\"VITB6A\":{\"label\":\"Vitamin B-6\",\"quantity\":0.0,\"unit\":\"mg\"},\"VITB12\":{\"label\":\"Vitamin B-12\",\"quantity\":0.0,\"unit\":\"µg\"},\"FIBTG\":{\"label\":\"Fiber, total dietary\",\"quantity\":0.0,\"unit\":\"g\"},\"WATER\":{\"label\":\"Water\",\"quantity\":236.28900000000002,\"unit\":\"g\"},\"K\":{\"label\":\"Potassium, K\",\"quantity\":87.69,\"unit\":\"mg\"},\"P\":{\"label\":\"Phosphorus, P\",\"quantity\":2.37,\"unit\":\"mg\"},\"NA\":{\"label\":\"Sodium, Na\",\"quantity\":7.11,\"unit\":\"mg\"},\"ZN\":{\"label\":\"Zinc, Zn\",\"quantity\":0.047400000000000005,\"unit\":\"mg\"},\"SUGAR\":{\"label\":\"Sugars, total\",\"quantity\":0.0,\"unit\":\"g\"},\"CA\":{\"label\":\"Calcium, Ca\",\"quantity\":0.0,\"unit\":\"mg\"},\"MG\":{\"label\":\"Magnesium, Mg\",\"quantity\":7.11,\"unit\":\"mg\"},\"FE\":{\"label\":\"Iron, Fe\",\"quantity\":0.047400000000000005,\"unit\":\"mg\"},\"VITK1\":{\"label\":\"Vitamin K (phylloquinone)\",\"quantity\":0.0,\"unit\":\"µg\"},\"FOLFD\":{\"label\":\"Folate, food\",\"quantity\":11.85,\"unit\":\"µg\"},\"FOLAC\":{\"label\":\"Folic acid\",\"quantity\":0.0,\"unit\":\"µg\"},\"FOLDFE\":{\"label\":\"Folate, DFE\",\"quantity\":11.85,\"unit\":\"µg\"}},\"measureURI\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_cup\",\"status\":\"OK\"}]}]}"
        val gson = Gson()
        val nutritionResponse = gson.fromJson(response, NutritionResponse::class.java)
        val bundle = Bundle()
        bundle.putParcelable("ingredients", nutritionResponse)
        launchFragmentInHiltContainer<TotalAnalysisFragment>(
            bundle
        )
        onView(withId(R.id.textView)).check(matches(isDisplayed()))
        onView(withId(R.id.calories)).check(matches(withText(nutritionResponse.calories.toString())))
        onView(withId(R.id.total_fat_percentage)).check(matches(withText(roundDouble(nutritionResponse.totalDaily.FAT.quantity).toString() +" "+ nutritionResponse.totalDaily.FAT.unit)))
        onView(withId(R.id.saturated_fat_percentage)).check(matches(withText(roundDouble(nutritionResponse.totalDaily.FASAT.quantity).toString() +" "+ nutritionResponse.totalDaily.FASAT.unit)))
        onView(withId(R.id.cholesterol_percentage)).check(matches(withText(roundDouble(nutritionResponse.totalDaily.CHOLE.quantity).toString() +" "+ nutritionResponse.totalDaily.CHOLE.unit)))
        onView(withId(R.id.sodium_percentage)).check(matches(withText(roundDouble(nutritionResponse.totalDaily.NA.quantity).toString() +" "+ nutritionResponse.totalDaily.NA.unit)))
        onView(withId(R.id.total_carbohydrate_percentage)).check(matches(withText(roundDouble(nutritionResponse.totalDaily.CHOCDF.quantity).toString()  +" "+ nutritionResponse.totalDaily.CHOCDF.unit)))
        onView(withId(R.id.protein_percentage)).check(matches(withText(roundDouble(nutritionResponse.totalDaily.PROCNT.quantity).toString() +" "+ nutritionResponse.totalDaily.PROCNT.unit)))
        onView(withId(R.id.vitamin_d_percentage)).check(matches(withText(roundDouble(nutritionResponse.totalDaily.VITD.quantity).toString() +" "+ nutritionResponse.totalDaily.VITD.unit)))
        onView(withId(R.id.calcium_percentage)).check(matches(withText(roundDouble(nutritionResponse.totalDaily.CA.quantity).toString() +" "+ nutritionResponse.totalDaily.CA.unit)))
        onView(withId(R.id.iron_percentage)).check(matches(withText(roundDouble(nutritionResponse.totalDaily.FE.quantity).toString() +" "+ nutritionResponse.totalDaily.FE.unit)))
        onView(withId(R.id.potassium_percentage)).check(matches(withText(roundDouble(nutritionResponse.totalDaily.K.quantity).toString() +" "+ nutritionResponse.totalDaily.K.unit)))
    }

    private fun roundDouble(double: Double) : Int{
        return double.roundToInt()
    }
}